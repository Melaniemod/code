
import tensorflow as tf
import numpy as  np


# todo py36
def input_fn(filenames, batch_size=32, num_epochs=1, perform_shuffle=False):
    print('Parsing', filenames)
    def decode_libsvm(line):
        columns = tf.string_split([line], ' ')
        labels = tf.string_to_number(columns.values[0], out_type=tf.float32)
        splits = tf.string_split(columns.values[1:], ':')
        # todo 这里没有index就直接reshape成
        id_vals = tf.reshape(splits.values,splits.dense_shape)
        # print("splits=",splits,splits.values,splits.dense_shape,id_vals)
        feat_ids, feat_vals = tf.split(id_vals,num_or_size_splits=2,axis=1)
        feat_ids = tf.string_to_number(feat_ids, out_type=tf.int32)
        feat_vals = tf.string_to_number(feat_vals, out_type=tf.float32)
        return {"feat_ids": feat_ids, "feat_vals": feat_vals}, labels,columns,splits.values,splits.dense_shape,splits,id_vals

    # Extract lines from input files using the Dataset API, can pass one filename or filename list
    dataset = tf.data.TextLineDataset(filenames).map(decode_libsvm, num_parallel_calls=10).prefetch(500000)    # multi-thread pre-process then prefetch
    dataset = tf.data.TextLineDataset(filenames).map(decode_libsvm, num_parallel_calls=10).prefetch(500000)
    print('1111111111e')

    # Randomizes input using a window of 256 elements (read into memory)
    if perform_shuffle:
        dataset = dataset.shuffle(buffer_size=256)

    # epochs from blending together.
    dataset = dataset.repeat(num_epochs)
    dataset = dataset.batch(batch_size) # Batch size to use

    #return dataset.make_one_shot_iterator()
    iterator = dataset.make_one_shot_iterator()
    batch_features, batch_labels,columns,value,shape,splits,id_vals = iterator.get_next()
    #return tf.reshape(batch_ids,shape=[-1,field_size]), tf.reshape(batch_vals,shape=[-1,field_size]), batch_labels
    return batch_features, batch_labels,columns,value,shape,splits,id_vals



data_file = '/Users/wmy/workspace/project/rec/data/criteo/te.libsvm'
data_file = ['../../data/criteo/te.libsvm']

feat,label,columns,value,shape,splits,id_vals = input_fn(data_file)



# todo 这里每run一次就取一次迭代器中的数据
with tf.Session() as sess:
    tmp = sess.run(value)
    print(tmp.tolist(),tmp.shape)
    print("shape",sess.run(shape))
    print("columns=",sess.run(columns))
    print("splits=",sess.run(splits))

    value,shape,columns,splits,id_vals = sess.run((value,shape,columns,splits,id_vals))
    print("value=",value.tolist(),"\nvalue.shape=",value.shape,"\nshape=",shape,"\ncolumns=",columns,"\nsplits=",splits,'\nid_vals=',id_vals,'id_vals.shape',id_vals.shape)
    # todo 数据如下


'''

value= [[b'1', b'0.05', b'2', b'4.180763', b'3', b'0.08', b'4', b'0.06', b'5', b'0.012844', b'6', b'0.09', b'7', b'0.04', b'8', b'0.6', b'9', b'0.442', b'10', b'0.1', b'11', b'0.3', b'12', b'0', b'13', b'0.4', b'14', b'1', b'558', b'1', b'1730', b'1', b'12390', b'1', b'26191', b'1', b'26341', b'1', b'27068', b'1', b'35362', b'1', b'35613', b'1', b'35824', b'1', b'47442', b'1', b'52042', b'1', b'63192', b'1', b'65962', b'1', b'65991', b'1', b'71651', b'1', b'84089', b'1', b'84112', b'1', b'86888', b'1', b'88279', b'1', b'88769', b'1', b'100288', b'1', b'100302', b'1', b'100320', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0.1', b'2', b'0.003317', b'3', b'0', b'4', b'0', b'5', b'0.002734', b'6', b'0.016', b'7', b'0.02', b'8', b'0.16', b'9', b'0.016', b'10', b'0.1', b'11', b'0.1', b'12', b'0', b'13', b'0', b'14', b'1', b'598', b'1', b'1085', b'1', b'12376', b'1', b'26190', b'1', b'26341', b'1', b'26519', b'1', b'35359', b'1', b'35613', b'1', b'35697', b'1', b'47357', b'1', b'51372', b'1', b'63102', b'1', b'65964', b'1', b'66065', b'1', b'71637', b'1', b'84089', b'1', b'84162', b'1', b'86889', b'1', b'88281', b'1', b'88292', b'1', b'100290', b'1', b'100305', b'1', b'100316', b'1', b'109932', b'1', b'110004', b'1'], [b'1', b'0', b'2', b'1.640133', b'3', b'0.01', b'4', b'0', b'5', b'2.101766', b'6', b'0', b'7', b'0', b'8', b'0.22', b'9', b'0', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0', b'17', b'1', b'598', b'1', b'1085', b'1', b'12376', b'1', b'26190', b'1', b'26341', b'1', b'27700', b'1', b'35360', b'1', b'35614', b'1', b'36535', b'1', b'47785', b'1', b'51372', b'1', b'63523', b'1', b'65964', b'1', b'66065', b'1', b'71637', b'1', b'84088', b'1', b'84162', b'1', b'86889', b'1', b'88281', b'1', b'88292', b'1', b'100290', b'1', b'100300', b'1', b'100316', b'1', b'109932', b'1', b'110004', b'1'], [b'1', b'0', b'2', b'0.006633', b'3', b'0.89', b'4', b'0.04', b'5', b'0.200766', b'6', b'0', b'7', b'0', b'8', b'0.08', b'9', b'0.004', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0.04', b'14', b'1', b'552', b'1', b'1078', b'1', b'19662', b'1', b'26190', b'1', b'26340', b'1', b'26412', b'1', b'35369', b'1', b'35613', b'1', b'35655', b'1', b'48125', b'1', b'51364', b'1', b'63001', b'1', b'65962', b'1', b'66534', b'1', b'77892', b'1', b'84088', b'1', b'84383', b'1', b'87003', b'1', b'88281', b'1', b'94193', b'1', b'100288', b'1', b'100299', b'1', b'100389', b'1', b'109932', b'1', b'110082', b'1'], [b'1', b'0.3', b'2', b'0.804312', b'3', b'0', b'4', b'0', b'5', b'0.00225', b'6', b'0.004', b'7', b'0.86', b'8', b'0.6', b'9', b'1.006', b'10', b'0.1', b'11', b'2.3', b'12', b'0', b'13', b'0', b'16', b'1', b'579', b'1', b'1079', b'1', b'12368', b'1', b'26191', b'1', b'26341', b'1', b'26592', b'1', b'35360', b'1', b'35613', b'1', b'37698', b'1', b'47458', b'1', b'51365', b'1', b'63210', b'1', b'65968', b'1', b'66035', b'1', b'71629', b'1', b'84094', b'1', b'84155', b'1', b'86888', b'1', b'88279', b'1', b'88284', b'1', b'100288', b'1', b'100305', b'1', b'100316', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.003317', b'3', b'0', b'4', b'0', b'5', b'0.068547', b'6', b'0.026', b'7', b'0.28', b'8', b'0', b'9', b'0.04', b'10', b'0', b'11', b'0.6', b'12', b'0', b'13', b'0', b'15', b'1', b'587', b'1', b'1078', b'1', b'12367', b'1', b'26190', b'1', b'26343', b'1', b'31268', b'1', b'35359', b'1', b'35613', b'1', b'41848', b'1', b'47724', b'1', b'51364', b'1', b'63468', b'1', b'65962', b'1', b'66133', b'1', b'71628', b'1', b'84088', b'1', b'84144', b'1', b'86953', b'1', b'88280', b'1', b'88283', b'1', b'100288', b'1', b'100300', b'1', b'102683', b'1', b'109940', b'1', b'111766', b'1'], [b'1', b'0', b'2', b'0.013267', b'3', b'0.48', b'4', b'0.14', b'5', b'0.003766', b'6', b'0', b'7', b'0', b'8', b'0.16', b'9', b'0.014', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0.14', b'23', b'1', b'552', b'1', b'1078', b'1', b'12367', b'1', b'26190', b'1', b'26343', b'1', b'28254', b'1', b'35359', b'1', b'35613', b'1', b'37215', b'1', b'47451', b'1', b'51364', b'1', b'63174', b'1', b'65962', b'1', b'66003', b'1', b'71628', b'1', b'84091', b'1', b'84103', b'1', b'86952', b'1', b'88280', b'1', b'88283', b'1', b'100288', b'1', b'100300', b'1', b'100313', b'1', b'109932', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.003317', b'3', b'0', b'4', b'0', b'5', b'0.057328', b'6', b'0.236', b'7', b'0.01', b'8', b'0.28', b'9', b'0.186', b'10', b'0', b'11', b'0.1', b'12', b'0.1', b'13', b'0', b'14', b'1', b'579', b'1', b'1079', b'1', b'12368', b'1', b'26190', b'1', b'26342', b'1', b'29183', b'1', b'35361', b'1', b'35613', b'1', b'41514', b'1', b'48088', b'1', b'51365', b'1', b'63510', b'1', b'65964', b'1', b'66125', b'1', b'71629', b'1', b'84091', b'1', b'84244', b'1', b'86888', b'1', b'88279', b'1', b'88284', b'1', b'100288', b'1', b'100300', b'1', b'100316', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0.15', b'2', b'0.004975', b'3', b'0.01', b'4', b'0.04', b'5', b'0.022094', b'6', b'0.204', b'7', b'0.47', b'8', b'0.8', b'9', b'0.462', b'10', b'0', b'11', b'0.4', b'12', b'0', b'13', b'0.04', b'17', b'1', b'546', b'1', b'1090', b'1', b'12381', b'1', b'26190', b'1', b'26343', b'1', b'26392', b'1', b'35360', b'1', b'35613', b'1', b'35624', b'1', b'47176', b'1', b'51377', b'1', b'62927', b'1', b'65962', b'1', b'66147', b'1', b'71642', b'1', b'84088', b'1', b'84150', b'1', b'86888', b'1', b'88279', b'1', b'88297', b'1', b'100288', b'1', b'100300', b'1', b'100331', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.043118', b'3', b'0.1', b'4', b'0.04', b'5', b'0.066906', b'6', b'0.048', b'7', b'0.12', b'8', b'0.04', b'9', b'0.202', b'10', b'0', b'11', b'0.1', b'12', b'0', b'13', b'0.06', b'14', b'1', b'569', b'1', b'1078', b'1', b'12367', b'1', b'26206', b'1', b'26342', b'1', b'27799', b'1', b'35359', b'1', b'35613', b'1', b'35617', b'1', b'47328', b'1', b'51364', b'1', b'63095', b'1', b'65963', b'1', b'66048', b'1', b'71628', b'1', b'84091', b'1', b'84120', b'1', b'86889', b'1', b'88282', b'1', b'88283', b'1', b'100289', b'1', b'100299', b'1', b'100314', b'1', b'109939', b'1', b'109983', b'1'], [b'1', b'0', b'2', b'0.016584', b'3', b'0.01', b'4', b'0.02', b'5', b'0.013125', b'6', b'0', b'7', b'0', b'8', b'0.02', b'9', b'0.002', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0.02', b'15', b'1', b'967', b'1', b'1078', b'1', b'13012', b'1', b'26190', b'1', b'26345', b'1', b'27695', b'1', b'35360', b'1', b'35613', b'1', b'35617', b'1', b'48414', b'1', b'51364', b'1', b'64046', b'1', b'65962', b'1', b'67897', b'1', b'71628', b'1', b'84092', b'1', b'85247', b'1', b'86888', b'1', b'88279', b'1', b'88283', b'1', b'100292', b'1', b'100303', b'1', b'100722', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.034826', b'3', b'0.03', b'4', b'0.32', b'5', b'0.04875', b'6', b'0.834', b'7', b'0.12', b'8', b'0.28', b'9', b'0.822', b'10', b'0', b'11', b'0.3', b'12', b'0', b'13', b'0.4', b'18', b'1', b'598', b'1', b'1085', b'1', b'12376', b'1', b'26190', b'1', b'26341', b'1', b'26407', b'1', b'35362', b'1', b'35613', b'1', b'41257', b'1', b'47251', b'1', b'51372', b'1', b'63014', b'1', b'65964', b'1', b'66065', b'1', b'71637', b'1', b'84088', b'1', b'84162', b'1', b'86889', b'1', b'88281', b'1', b'88292', b'1', b'100288', b'1', b'100302', b'1', b'100316', b'1', b'109932', b'1', b'110004', b'1'], [b'1', b'0', b'2', b'0.197347', b'3', b'0.03', b'4', b'0.02', b'5', b'0.015453', b'6', b'0.012', b'7', b'0.03', b'8', b'0.02', b'9', b'0.012', b'10', b'0', b'11', b'0.2', b'12', b'0', b'13', b'0.02', b'15', b'1', b'552', b'1', b'1078', b'1', b'12367', b'1', b'26191', b'1', b'26340', b'1', b'26393', b'1', b'35362', b'1', b'35613', b'1', b'35629', b'1', b'47220', b'1', b'51364', b'1', b'62978', b'1', b'65969', b'1', b'66293', b'1', b'71628', b'1', b'84089', b'1', b'84103', b'1', b'87229', b'1', b'88282', b'1', b'88283', b'1', b'100288', b'1', b'100299', b'1', b'100314', b'1', b'109932', b'1', b'109983', b'1'], [b'1', b'0.3', b'2', b'4.631841', b'3', b'0.16', b'4', b'0', b'5', b'0.002609', b'6', b'0.012', b'7', b'0.42', b'8', b'0.12', b'9', b'1.074', b'10', b'0.1', b'11', b'1.1', b'12', b'0', b'13', b'0.12', b'15', b'1', b'585', b'1', b'1078', b'1', b'12367', b'1', b'26191', b'1', b'26341', b'1', b'26354', b'1', b'35360', b'1', b'35613', b'1', b'35617', b'1', b'47174', b'1', b'51364', b'1', b'62925', b'1', b'65963', b'1', b'66088', b'1', b'71628', b'1', b'84088', b'1', b'84154', b'1', b'86889', b'1', b'88281', b'1', b'88283', b'1', b'100288', b'1', b'100299', b'1', b'100538', b'1', b'109938', b'1', b'109988', b'1'], [b'1', b'0', b'2', b'0.039801', b'3', b'0.02', b'4', b'0.52', b'5', b'0.023016', b'6', b'0.084', b'7', b'0.08', b'8', b'0.54', b'9', b'0.188', b'10', b'0', b'11', b'0.4', b'12', b'0', b'13', b'0.52', b'14', b'1', b'567', b'1', b'1079', b'1', b'12368', b'1', b'26193', b'1', b'26341', b'1', b'26854', b'1', b'35359', b'1', b'35613', b'1', b'37744', b'1', b'47711', b'1', b'51365', b'1', b'63459', b'1', b'65962', b'1', b'66214', b'1', b'71629', b'1', b'84088', b'1', b'84247', b'1', b'86888', b'1', b'88279', b'1', b'88284', b'1', b'100288', b'1', b'100299', b'1', b'100316', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.013267', b'3', b'0', b'4', b'0', b'5', b'1.719734', b'6', b'0', b'7', b'0', b'8', b'0', b'9', b'0', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0', b'14', b'1', b'648', b'1', b'1100', b'1', b'12392', b'1', b'26190', b'1', b'26341', b'1', b'33058', b'1', b'35384', b'1', b'35614', b'1', b'35617', b'1', b'50730', b'1', b'51387', b'1', b'63184', b'1', b'65962', b'1', b'66323', b'1', b'71659', b'1', b'84088', b'1', b'84238', b'1', b'86889', b'1', b'88280', b'1', b'88310', b'1', b'100288', b'1', b'100300', b'1', b'100337', b'1', b'109937', b'1', b'110030', b'1'], [b'1', b'0', b'2', b'0.006633', b'3', b'0.03', b'4', b'0', b'5', b'0.092', b'6', b'0.512', b'7', b'0.03', b'8', b'0.48', b'9', b'0.342', b'10', b'0', b'11', b'0.2', b'12', b'0', b'13', b'0.06', b'14', b'1', b'579', b'1', b'1079', b'1', b'12368', b'1', b'26190', b'1', b'26341', b'1', b'26455', b'1', b'35359', b'1', b'35613', b'1', b'35645', b'1', b'47256', b'1', b'51365', b'1', b'63017', b'1', b'65964', b'1', b'66125', b'1', b'71629', b'1', b'84089', b'1', b'84244', b'1', b'86888', b'1', b'88279', b'1', b'88284', b'1', b'100288', b'1', b'100302', b'1', b'100316', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.004975', b'3', b'0.06', b'4', b'0.1', b'5', b'0.112922', b'6', b'0', b'7', b'0', b'8', b'0.18', b'9', b'0.016', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0.1', b'15', b'1', b'572', b'1', b'1078', b'1', b'12406', b'1', b'26196', b'1', b'26344', b'1', b'26379', b'1', b'35360', b'1', b'35613', b'1', b'35850', b'1', b'47215', b'1', b'51364', b'1', b'62973', b'1', b'65965', b'1', b'66366', b'1', b'72341', b'1', b'84088', b'1', b'84255', b'1', b'86888', b'1', b'88279', b'1', b'88283', b'1', b'100288', b'1', b'100299', b'1', b'100339', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0.05', b'2', b'0.004975', b'3', b'0', b'4', b'0', b'5', b'0.005641', b'6', b'0.034', b'7', b'0.08', b'8', b'0.8', b'9', b'0.088', b'10', b'0.1', b'11', b'0.3', b'12', b'0', b'13', b'0', b'15', b'1', b'579', b'1', b'1079', b'1', b'12368', b'1', b'26190', b'1', b'26342', b'1', b'26455', b'1', b'35362', b'1', b'35613', b'1', b'39634', b'1', b'47256', b'1', b'51365', b'1', b'63017', b'1', b'65964', b'1', b'66125', b'1', b'71629', b'1', b'84088', b'1', b'84244', b'1', b'86888', b'1', b'88279', b'1', b'88284', b'1', b'100288', b'1', b'100302', b'1', b'100316', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.066335', b'3', b'0.03', b'4', b'0.08', b'5', b'0.094469', b'6', b'0.052', b'7', b'0.16', b'8', b'0.08', b'9', b'0.056', b'10', b'0', b'11', b'0.1', b'12', b'0.2', b'13', b'0.08', b'14', b'1', b'579', b'1', b'1079', b'1', b'12368', b'1', b'26191', b'1', b'26343', b'1', b'26627', b'1', b'35359', b'1', b'35613', b'1', b'35750', b'1', b'47256', b'1', b'51365', b'1', b'63017', b'1', b'65968', b'1', b'66035', b'1', b'71629', b'1', b'84093', b'1', b'84155', b'1', b'86888', b'1', b'88279', b'1', b'88284', b'1', b'100288', b'1', b'100306', b'1', b'100316', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0.05', b'2', b'0.006633', b'3', b'0.21', b'4', b'0.68', b'5', b'0.003031', b'6', b'0.204', b'7', b'0.01', b'8', b'0.36', b'9', b'0.2', b'10', b'0.1', b'11', b'0.1', b'12', b'0', b'13', b'2', b'14', b'1', b'606', b'1', b'1100', b'1', b'12392', b'1', b'26198', b'1', b'26343', b'1', b'26412', b'1', b'35360', b'1', b'35613', b'1', b'35655', b'1', b'47291', b'1', b'51387', b'1', b'63001', b'1', b'65964', b'1', b'66274', b'1', b'71659', b'1', b'84090', b'1', b'84165', b'1', b'86889', b'1', b'88280', b'1', b'88310', b'1', b'100290', b'1', b'100300', b'1', b'100337', b'1', b'109932', b'1', b'110030', b'1'], [b'1', b'0', b'2', b'0.003317', b'3', b'2', b'4', b'0.4', b'5', b'0.227844', b'6', b'1.068', b'7', b'0.03', b'8', b'0.6', b'9', b'0.19', b'10', b'0', b'11', b'0.1', b'12', b'0', b'13', b'0.6', b'20', b'1', b'554', b'1', b'1078', b'1', b'12702', b'1', b'26190', b'1', b'26341', b'1', b'26540', b'1', b'35362', b'1', b'35613', b'1', b'45351', b'1', b'47205', b'1', b'51364', b'1', b'62961', b'1', b'65964', b'1', b'66016', b'1', b'71628', b'1', b'84089', b'1', b'84102', b'1', b'86904', b'1', b'88280', b'1', b'88283', b'1', b'100288', b'1', b'100301', b'1', b'100650', b'1', b'109935', b'1', b'110215', b'1'], [b'1', b'0', b'2', b'0.008292', b'3', b'0', b'4', b'0.04', b'5', b'0.024766', b'6', b'0.038', b'7', b'0.2', b'8', b'0.26', b'9', b'0.512', b'10', b'0', b'11', b'0.4', b'12', b'0', b'13', b'0.04', b'14', b'1', b'546', b'1', b'1078', b'1', b'12367', b'1', b'26190', b'1', b'26343', b'1', b'26555', b'1', b'35360', b'1', b'35613', b'1', b'35664', b'1', b'47343', b'1', b'51364', b'1', b'63112', b'1', b'65963', b'1', b'66568', b'1', b'71628', b'1', b'84088', b'1', b'84346', b'1', b'86888', b'1', b'88279', b'1', b'88283', b'1', b'100288', b'1', b'100301', b'1', b'102010', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.008292', b'3', b'0.72', b'4', b'0.1', b'5', b'0.486734', b'6', b'0.25', b'7', b'0.33', b'8', b'0.1', b'9', b'0.246', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0.1', b'14', b'1', b'549', b'1', b'1078', b'1', b'12367', b'1', b'26194', b'1', b'26340', b'1', b'26387', b'1', b'35359', b'1', b'35614', b'1', b'36235', b'1', b'47183', b'1', b'51364', b'1', b'62937', b'1', b'65963', b'1', b'66022', b'1', b'71628', b'1', b'84088', b'1', b'84099', b'1', b'87067', b'1', b'88280', b'1', b'88283', b'1', b'100288', b'1', b'100304', b'1', b'109556', b'1', b'109934', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.004975', b'3', b'0.01', b'4', b'0.28', b'5', b'4.932359', b'6', b'0', b'7', b'0', b'8', b'0.02', b'9', b'3.716', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0.28', b'14', b'1', b'651', b'1', b'1078', b'1', b'12866', b'1', b'26190', b'1', b'26341', b'1', b'27322', b'1', b'35360', b'1', b'35614', b'1', b'36770', b'1', b'47359', b'1', b'51364', b'1', b'63123', b'1', b'65963', b'1', b'70400', b'1', b'71628', b'1', b'84088', b'1', b'86046', b'1', b'86889', b'1', b'88280', b'1', b'88283', b'1', b'100288', b'1', b'100304', b'1', b'100351', b'1', b'109932', b'1', b'110809', b'1'], [b'1', b'0.85', b'2', b'0.374793', b'3', b'0.06', b'4', b'0.26', b'5', b'0.000063', b'6', b'0', b'7', b'0.17', b'8', b'0.32', b'9', b'0.032', b'10', b'0.1', b'11', b'0.1', b'12', b'1.7', b'13', b'0', b'14', b'1', b'546', b'1', b'1078', b'1', b'13589', b'1', b'26191', b'1', b'26341', b'1', b'26358', b'1', b'35360', b'1', b'35613', b'1', b'35617', b'1', b'47186', b'1', b'51364', b'1', b'62935', b'1', b'65962', b'1', b'68084', b'1', b'71628', b'1', b'84094', b'1', b'84415', b'1', b'86888', b'1', b'88279', b'1', b'88283', b'1', b'100288', b'1', b'100300', b'1', b'100501', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.646766', b'3', b'0', b'4', b'0', b'5', b'0.383437', b'6', b'0', b'7', b'0.04', b'8', b'0', b'9', b'0', b'10', b'0', b'11', b'0.1', b'12', b'0', b'13', b'0', b'18', b'1', b'555', b'1', b'1078', b'1', b'13125', b'1', b'26192', b'1', b'26341', b'1', b'29257', b'1', b'35359', b'1', b'35613', b'1', b'35617', b'1', b'48727', b'1', b'51364', b'1', b'64318', b'1', b'65962', b'1', b'66045', b'1', b'71628', b'1', b'84092', b'1', b'84119', b'1', b'86889', b'1', b'88280', b'1', b'88283', b'1', b'100288', b'1', b'100299', b'1', b'100317', b'1', b'109932', b'1', b'113570', b'1'], [b'1', b'0.1', b'2', b'3.640133', b'3', b'0.05', b'4', b'0', b'5', b'0.001344', b'6', b'0.01', b'7', b'0.05', b'8', b'0', b'9', b'0.006', b'10', b'0.1', b'11', b'0.2', b'12', b'0', b'13', b'0', b'14', b'1', b'598', b'1', b'1085', b'1', b'12376', b'1', b'26190', b'1', b'26341', b'1', b'27281', b'1', b'35361', b'1', b'35613', b'1', b'35617', b'1', b'47791', b'1', b'51372', b'1', b'63528', b'1', b'65964', b'1', b'66065', b'1', b'71637', b'1', b'84088', b'1', b'84162', b'1', b'86889', b'1', b'88281', b'1', b'88292', b'1', b'100288', b'1', b'100300', b'1', b'100316', b'1', b'109932', b'1', b'110004', b'1'], [b'1', b'0', b'2', b'0.046434', b'3', b'0.07', b'4', b'0.5', b'5', b'0.181922', b'6', b'2.04', b'7', b'0.01', b'8', b'0.02', b'9', b'1.91', b'10', b'0', b'11', b'0.1', b'12', b'0', b'13', b'0.9', b'20', b'1', b'552', b'1', b'1081', b'1', b'12371', b'1', b'26192', b'1', b'26342', b'1', b'30292', b'1', b'35359', b'1', b'35613', b'1', b'41087', b'1', b'49342', b'1', b'51368', b'1', b'64794', b'1', b'65968', b'1', b'66020', b'1', b'71632', b'1', b'84090', b'1', b'84118', b'1', b'86894', b'1', b'88281', b'1', b'88287', b'1', b'100288', b'1', b'100299', b'1', b'100317', b'1', b'109932', b'1', b'109989', b'1'], [b'1', b'0', b'2', b'1.505804', b'3', b'0.09', b'4', b'0.14', b'5', b'0.223703', b'6', b'0.09', b'7', b'0.48', b'8', b'0.18', b'9', b'0.156', b'10', b'0', b'11', b'0.2', b'12', b'0', b'13', b'0.16', b'14', b'1', b'579', b'1', b'1079', b'1', b'12368', b'1', b'26190', b'1', b'26341', b'1', b'29272', b'1', b'35359', b'1', b'35613', b'1', b'39976', b'1', b'47592', b'1', b'51365', b'1', b'63345', b'1', b'65968', b'1', b'66035', b'1', b'71629', b'1', b'84088', b'1', b'84155', b'1', b'86888', b'1', b'88279', b'1', b'88284', b'1', b'100288', b'1', b'100305', b'1', b'100316', b'1', b'109930', b'1', b'109982', b'1'], [b'1', b'0', b'2', b'0.004975', b'3', b'0.19', b'4', b'0.02', b'5', b'1.033953', b'6', b'0.116', b'7', b'0', b'8', b'0.02', b'9', b'0.036', b'10', b'0', b'11', b'0', b'12', b'0', b'13', b'0.02', b'14', b'1', b'597', b'1', b'1078', b'1', b'12367', b'1', b'26191', b'1', b'26343', b'1', b'29265', b'1', b'35359', b'1', b'35614', b'1', b'36160', b'1', b'47661', b'1', b'51364', b'1', b'63408', b'1', b'65963', b'1', b'66129', b'1', b'71628', b'1', b'84088', b'1', b'84152', b'1', b'86889', b'1', b'88282', b'1', b'88283', b'1', b'100288', b'1', b'100300', b'1', b'101302', b'1', b'109933', b'1', b'110713', b'1'], [b'1', b'2.4', b'2', b'0.004975', b'3', b'0.05', b'4', b'0.1', b'5', b'0', b'6', b'0', b'7', b'1.6', b'8', b'0.1', b'9', b'0.06', b'10', b'0.1', b'11', b'1', b'12', b'0', b'13', b'0', b'14', b'1', b'569', b'1', b'1078', b'1', b'12367', b'1', b'26190', b'1', b'26341', b'1', b'26739', b'1', b'35359', b'1', b'35613', b'1', b'35902', b'1', b'47207', b'1', b'51364', b'1', b'62964', b'1', b'65964', b'1', b'66144', b'1', b'71628', b'1', b'84088', b'1', b'84120', b'1', b'87305', b'1', b'88282', b'1', b'88283', b'1', b'100289', b'1', b'100301', b'1', b'100313', b'1', b'109939', b'1', b'109982', b'1']] 
value.shape= (32, 78)
shape= [[39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]
 [39  2]] 
columns= SparseTensorValue(indices=array([[ 0,  0,  0],
       [ 0,  0,  1],
       [ 0,  0,  2],
       ...,
       [31,  0, 37],
       [31,  0, 38],
       [31,  0, 39]]), values=array([b'0', b'1:0.05', b'2:4.180763', ..., b'100313:1', b'109939:1',
       b'109982:1'], dtype=object), dense_shape=array([32,  1, 40])) 
splits= SparseTensorValue(indices=array([[ 0,  0,  0],
       [ 0,  0,  1],
       [ 0,  1,  0],
       ...,
       [31, 37,  1],
       [31, 38,  0],
       [31, 38,  1]]), values=array([b'1', b'0.05', b'2', ..., b'1', b'109982', b'1'], dtype=object), dense_shape=array([32, 39,  2]))
id_vals= [[[b'1' b'0.05']
  [b'2' b'4.180763']
  [b'3' b'0.08']
  ...
  [b'100320' b'1']
  [b'109930' b'1']
  [b'109982' b'1']]

 [[b'1' b'0.1']
  [b'2' b'0.003317']
  [b'3' b'0']
  ...
  [b'100316' b'1']
  [b'109932' b'1']
  [b'110004' b'1']]

 [[b'1' b'0']
  [b'2' b'1.640133']
  [b'3' b'0.01']
  ...
  [b'100316' b'1']
  [b'109932' b'1']
  [b'110004' b'1']]

 ...

 [[b'1' b'0']
  [b'2' b'1.505804']
  [b'3' b'0.09']
  ...
  [b'100316' b'1']
  [b'109930' b'1']
  [b'109982' b'1']]

 [[b'1' b'0']
  [b'2' b'0.004975']
  [b'3' b'0.19']
  ...
  [b'101302' b'1']
  [b'109933' b'1']
  [b'110713' b'1']]

 [[b'1' b'2.4']
  [b'2' b'0.004975']
  [b'3' b'0.05']
  ...
  [b'100313' b'1']
  [b'109939' b'1']
  [b'109982' b'1']]]
id_vals.shape (32, 39, 2)
'''

